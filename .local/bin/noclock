#!/bin/bash

# https://www.cyberciti.biz/faq/unix-linux-bash-get-time/

range() {
  if test "${1}" -ge "${2}" -a "${1}" -le "${3}"; then
    return 0
  else
    return 1
  fi
}

verbalTime() {
  hour="${1}"
  minute="${2}"

  range "${hour}" "13" "24" && hour=$((hour-12))
  #test "${hour}" -eq "13" && hour="1"
  #test "${hour}" -eq "14" && hour="2"
  #test "${hour}" -eq "15" && hour="3"
  #test "${hour}" -eq "16" && hour="4"
  #test "${hour}" -eq "17" && hour="5"
  #test "${hour}" -eq "18" && hour="6"
  #test "${hour}" -eq "19" && hour="7"
  #test "${hour}" -eq "20" && hour="8"
  #test "${hour}" -eq "21" && hour="9"
  #test "${hour}" -eq "22" && hour="10"
  #test "${hour}" -eq "23" && hour="11"
  #test "${hour}" -eq "24" && hour="12"

  if test "${minute}" -eq "0"; then
    printf "${hour}"
  elif range "${minute}" "1" "15"; then
    test "${minute}" -eq "15" && minute="kvart"
    printf "${minute} over ${hour}"
  elif range "${minute}" "16" "29"; then
    minute=$((30-minute))
    echo "${minute} på halv $((hour+1))"
  elif test "${minute}" -eq "30"; then
    printf "halv $((hour+1))"
  elif range "${minute}" "31" "44"; then
    minute=$((minute-30))
    printf "${minute} over halv $((hour+1))"
  elif range "${minute}" "45" "59"; then
    minute=$((60-minute))
    test "${minute}" -eq "15" && minute="kvart"
    printf "${minute} på $((hour+1))"
  fi
}

#while true; do
#  verbalTime "11" "$((i++))"
#  sleep 0.1
#  test "${i}" -ge "60" && exit 0
#done
if test "${1}" = "a"; then
  while true; do
    hour="$(TZ=Europe/Oslo date +'%H')"
    minute="$(TZ=Europe/Oslo date +'%M')"
    echo -ne "\r\r"
    verbalTime "${hour}" "${minute}"
    sleep 2
  done
else
    hour="$(TZ=Europe/Oslo date +'%H')"
    minute="$(TZ=Europe/Oslo date +'%M')"
    verbalTime "${hour}" "${minute}"
fi

